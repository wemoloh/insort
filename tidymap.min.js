(function(){'use strict';function c(k,l,m){let n=0,o=k.length;for(;n<o;){let p=h((n+o)/2);0<l(m,k[p])?n=p+1:o=p}return n}const d=Symbol('tidymap.CMP'),e=Symbol('tidymap.ORDER'),g=(k,l)=>(k+'').localeCompare(l);let h=Math.floor;class i extends Map{constructor(k=[],l=g){super();let m=[];for(let[n,o]of k){let p=this.size;super.set(n,o),p!==this.size&&m.push(n)}this[e]=m.sort(l),this[d]=l}clear(){super.clear(),this[e].length=0}delete(k){let l=super.delete(k);if(l){let m=this[e];m.splice(c(m,this[d],k),1)}return l}*entries(){for(let k of this[e])yield[k,this.get(k)]}forEach(k,l){for(let m of this[e])k.call(l,this.get(m),m,this)}keys(){return this[e][Symbol.iterator]()}set(k,l){let m=this.size;if(super.set(k,l),m!==this.size){let n=this[e];n.splice(c(n,this[d],k),0,k)}return this}*values(){for(let k of this[e])yield this.get(k)}}i.prototype[Symbol.iterator]=i.prototype.entries,i.TidyMap=i;class j extends Set{constructor(k=[],l=g){super();let m=[];for(let n of k){let o=this.size;super.add(n),o!==this.size&&m.push(n)}this[e]=m.sort(l),this[d]=l}add(k){let l=this.size;if(super.add(k),l!==this.size){let m=this[e];m.splice(c(m,this[d],k),0,k)}return this}clear(){super.clear(),this[e].length=0}delete(k){let l=super.delete(k);if(l){let m=this[e];m.splice(c(m,this[d],k),1)}return l}*entries(){for(let k of this[e])yield[k,k]}forEach(k,l){for(let m of this[e])k.call(l,m,m,this)}values(){return this[e][Symbol.iterator]()}}j.prototype.keys=j.prototype[Symbol.iterator]=j.prototype.values,i.TidySet=j,i.TidyObject=class{constructor(l={},m=g){Object.assign(this,l);let n=Object.keys(l).sort(m);return new Proxy(this,{ownKeys:()=>n,set:(o,p,q)=>{let r=Object.prototype.hasOwnProperty.call(o,p);return o[p]=q,r||n.splice(c(n,m,p),0,p),!0},deleteProperty:(o,p)=>{let q=Object.prototype.hasOwnProperty.call(o,p);return q&&(delete o[p],n.splice(c(n,m,p),1)),!0}})}},'undefined'!=typeof module&&!module.nodeType&&module.exports?module.exports=i:self.TidyMap=i})();
